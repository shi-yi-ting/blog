import{_ as k}from"./markDownBox-67bb66e6.js";import{_ as y,aA as c,o as u,c as m,d,j as l,N as a,O as C,Q as V,S as b,T,p as O,b as S}from"./index-dd7dc6e8.js";const _=axios.create({timeout:1e6});_.defaults.headers.post["Content-Type"]="application/json";const h=(t,e,s={})=>new Promise((n,o)=>{_({method:"get",url:t,params:e,...s}).then(r=>{n(r)}).catch(r=>{o(r)})}),B=(t,e,s={})=>new Promise((n,o)=>{_({method:"post",url:t,data:e,...s}).then(r=>{n(r)}).catch(r=>{o(r)})});const E={data(){return{cid:"",useType:"clickhouse",configList:[],formInfo:{cpu:"",part:""},formRules:{cpu:[{required:!0,message:"请输入0-100之间的整数",trigger:"blur"},{validator:(s,n,o)=>new RegExp("^(\\d|[1-9]\\d|100)$").test(n)?o():(o(new Error("请输入0-100之间的整数")),!1),trigger:"blur"}],part:[{required:!0,message:"请输入0-100000000之间的整数",trigger:"blur"},{validator:(s,n,o)=>/^(0|[1-9]\d{0,7}|10{8})$/.test(n.toString().trim())?o():(o(new Error("请输入0-100000000之间的整数")),!1),trigger:"blur"}]}}},methods:{async getConfigInfo(){let t={useType:this.useType+";presto"},e=await h("/mpmd/cluster/list",t);this.configList=e},getOptionId(t){let e=t.toString();this.formInfo.cid=e,this.setCookie("optionId",t),this.showOption(e)},async showOption(t){let s=await h("/mpmd/cluster/config/threshold",{cid:t});this.formInfo=s},saveInfo(){let t={cid:this.cid,cpu:this.formInfo.cpu,part:this.formInfo.part};this.$refs.form.validate(e=>{e&&B("/mpmd/cluster/config/threshold",t).then(s=>{s.code===0?this.$message({message:"保存成功!",type:"success"}):this.$message.error("保存失败!")})})},resetFormInfo(){this.$refs.form.resetFields()},setCookie(t,e){let s=30,n=new Date;n.setTime(n.getTime()+s*24*60*60*1e3),document.cookie=t+"="+escape(e)+";expires="+n.toGMTString()},getCookie(t){let e,s=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(s))?unescape(e[2]):null},defaultShowCluster(){this.region=parseInt(this.getCookie("optionId")),this.showOption(this.region)}},mounted(){this.getConfigInfo(),this.defaultShowCluster()}},L=t=>(O("data-v-5d939fd7"),t=t(),S(),t),$={style:{"padding-bottom":"40px"}},N={class:"container"},P={class:"form"},R=L(()=>d("div",{class:"title"},"集群告警参数配置",-1));function U(t,e,s,n,o,r){const g=c("el-option"),I=c("el-select"),p=c("el-form-item"),f=c("el-input"),w=c("el-button"),v=c("el-form");return u(),m("div",$,[d("div",N,[d("div",P,[R,l(v,{ref:"form",model:o.formInfo,rules:o.formRules,labelWidth:"140px",style:{width:"500px"}},{default:a(()=>[l(p,{label:"选择集群"},{default:a(()=>[l(I,{modelValue:o.cid,"onUpdate:modelValue":e[0]||(e[0]=i=>o.cid=i),placeholder:"请选择活动区域",style:{width:"100%"},onChange:e[1]||(e[1]=i=>r.getOptionId(i))},{default:a(()=>[(u(!0),m(C,null,V(o.configList,(i,x)=>(u(),b(g,{key:x,ref_for:!0,ref:"option",label:i.name,value:i.cid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"CPU使用率",prop:"cpu"},{default:a(()=>[l(f,{modelValue:o.formInfo.cpu,"onUpdate:modelValue":e[2]||(e[2]=i=>o.formInfo.cpu=i),maxlength:"3",showWordLimit:""},null,8,["modelValue"])]),_:1}),l(p,{label:"分区(Part)阈值",prop:"part"},{default:a(()=>[l(f,{modelValue:o.formInfo.part,"onUpdate:modelValue":e[3]||(e[3]=i=>o.formInfo.part=i),maxlength:"9",showWordLimit:""},null,8,["modelValue"])]),_:1}),l(p,null,{default:a(()=>[l(w,{type:"primary",onClick:r.saveInfo},{default:a(()=>[T("确定")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])])])}const D=y(E,[["render",U],["__scopeId","data-v-5d939fd7"]]);const F={class:"common_container"},W={class:"mt10"},j=d("div",{class:"ft20 fw700"},"validate",-1),q={class:"mt20"},G={__name:"validate",setup(t){return(e,s)=>{const n=k;return u(),m("div",F,[d("div",W,[l(n,{url:"static/file/md/demo/widget/consultant/dueBanner.md"},{default:a(()=>[d("div",null,[j,d("div",q,[l(D)])])]),_:1},8,["url"])])])}}};export{G as default};
